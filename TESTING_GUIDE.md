# SLA-Puzzle 测试指南

## 概述

本指南提供了 SLA-Puzzle 项目的测试相关信息，包括测试类型、测试文件结构、如何运行测试以及测试最佳实践。

## 测试类型

项目包含多种类型的测试，以确保不同层次的代码质量：

### 1. 集成测试

集成测试验证系统各个模块之间的协作是否正常，覆盖主要业务流程。

- **文件位置**：`integration-test.js`
- **测试范围**：用户认证、拼图生成、游戏流程、奖励系统、排行榜等完整流程

### 2. 单元测试

单元测试验证单个函数或组件的功能是否符合预期。

- **主要文件**：
  - `test-reward-system.js` - 奖励系统测试
  - `test-puzzle-generator.js` - 拼图生成器测试
  - `test-experience-system.js` - 经验值系统测试
  - `test-achievement.js` - 成就系统测试
  - `test-game-state.js` - 游戏状态管理测试
  - `comprehensive-leaderboard-test.js` - 排行榜综合测试

### 3. 诊断工具

诊断工具用于排查特定问题，提供问题定位和分析功能。

- **主要文件**：
  - `diagnose-full.js` - 完整诊断工具
  - `diagnose-simple.js` - 简化版诊断工具
  - `puzzle-purchase-sync-test.js` - 拼图购买同步测试
  - `test-diagnose.js` - 诊断工具测试

## 如何运行测试

### 运行集成测试

```bash
npm run test
# 或
pnpm run test
```

### 运行特定的测试文件

```bash
node test-reward-system.js
node test-puzzle-generator.js
# 等等
```

### 在浏览器中运行测试

1. 将测试文件添加到项目中
2. 在浏览器中打开应用程序
3. 打开浏览器控制台查看测试结果

## 测试环境要求

- Node.js 环境
- 项目依赖已安装 (`npm install` 或 `pnpm install`)

## 测试最佳实践

1. **开发前编写测试**：在实现新功能前，先编写相应的测试用例
2. **定期运行测试**：在提交代码前和部署前运行测试套件
3. **修复失败的测试**：发现测试失败后，立即分析并修复问题
4. **覆盖边界条件**：确保测试覆盖了正常流程和边界条件
5. **测试异常场景**：特别关注可能导致系统崩溃或异常行为的场景

## 测试报告解读

测试运行后，会在控制台输出详细的测试报告，包括：

- 测试用例的执行状态（通过/失败）
- 测试执行时间
- 成功和失败的测试数量
- 失败测试的具体错误信息

## 测试数据

测试中使用的模拟数据包括：

- 用户数据：用户名、密码、等级、经验值等
- 拼图配置：尺寸、形状、难度等
- 游戏结果：完成时间、步数、难度等

## 排查测试问题

如果测试失败，可以按照以下步骤进行排查：

1. 查看控制台输出的详细错误信息
2. 检查相关模块的实现代码
3. 确认测试环境和依赖是否正确
4. 检查模拟数据是否符合预期
5. 必要时添加更多的日志输出以定位问题

## 扩展测试

随着项目的发展，应不断扩展测试覆盖范围：

1. 添加新功能的测试用例
2. 优化现有测试，提高测试效率和覆盖率
3. 定期更新测试数据，确保测试的真实性
4. 考虑添加自动化测试工具，如 Jest 或 Cypress

## 注意事项

1. 测试文件应保持独立，不依赖于具体的环境配置
2. 避免在测试中修改生产数据
3. 测试用例应具有可重复性，每次运行应产生相同的结果
4. 合理使用模拟对象和数据，避免测试过于复杂